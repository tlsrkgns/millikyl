---
layout: post
title:  "BCD4 - Testing/Refactoring"
date:   2018-02-04 16:04
---
 저번주에 있어야할 Base Camp Day 3 은 서비스를 사용할 수 있도록 빌드하여 서버에 올리는데
<br>
주말까지 시간을 쓰느라 블로그 글을 쓰지 못했다.
<br>
## Base Camp Day 4
<br>
* day 4 에서는 프로젝트에 대한 피드백과 테스팅,리팩토링에 대한 기본적인 강의를 들었다. 젠킨스와 junit 을 사용하여 깨끗한 코드 만들기 과제가 주어졌지만
테스팅은 시작하지도 못하고 프로젝트의 구조 부터 뜯어고치기 시작했다.
<br>
### 코드리뷰 & 정적분석 결과
* 가장 많은 실수는 자바코드에 카멜표기법을 사용하지 않고 언더바를 사용한 것. 거의 모든 팀들이 DB에서 부터 시작된 데이터 이름 때문에 언더바를 사용했다.
처음에는 가벼운 실수라고 생각했다. 가볍게 이름만 고치면 되는줄 알았고 이 문제가 많은 시간을 잡아먹을 거라고는 생각 못했다.
<br>
* 작업을 시작하면서 이름을 몇가지 고쳤는데 이게 뷰에서 부터 REST api 서버까지 모든 부분을 고쳐야 했고 5명이서 각각 코딩한 부분을 한번에 고치지 않으면 
테스팅 조차 힘들었다. 하다가 이건 좀 아닌거 같은 느낌이 들고 나서야 팀원들과 회의를 하기 시작했다. 결론은 각자 구조를 바꾸고 모두 일이 끝난 후에 구역을
나눠서 이름을 한번에 바꿨다. 그리고 펑펑 터질줄 알았는데 버그가 생각보다 적었다는 사실에 조금 기뻤다. 이름 실수 외에도 로거대신 System.out.println를 사용한
부분등 신경써야할 부분들이 많이 있었다. 
<br>
* 처음으로 젠킨스를 봤다. 이 친구가 빌드를 시작할 때 마다 두근두근 하고 F를 띄우면 팀원들의 환호성을 들을 수 있었다. 테스트 코드를 작성해서 커버리지를 높혀야 
하고 널포인터예외 같은 심각한 문제들이 발생할 수 있는 부분이 가득한 것을 보았다. 코드중복 지표도 보여주는데 설정된 기준이 까다로웠다. 
<br><br>
### TDD / jUnit
* 테스트 주도 개발은 전에 들어본적이 있었다. 테스트 케이스를 먼저 작성한다는 것만 알고 있었고 그래서 'TDD를 왜 쓰는가' 는 잘 몰랐다. 강의를 듣고 나서도 몸으로 
그 필요성을 느끼려면 경험이 더 필요할 거라고 생각했다. TDD에 대한 중요한 부분은 공격적으로 리펙토링을 할 수 있게 만들어 준다는 점이다. 물론 코드를 만들면서
구조부터 띁어 고쳐야 할 부분들이 확연하게 들어났기에 단위 테스트를 위한 테스트 코드 작성은 시작도 못했다. 내가 짠 코드가 올바른지 검증할 수 있는 도구가 테스팅
인데 내 코드가 정상 작동한다고 당당하게 말할 수도 없는 상황이였다. 어쨌거나 커버리지를 높여야 했기에 테스트 코드를 짜기 시작했을 때는 '뭘 해야하지' 라는 생각이 
들었다.
<br>
* 다른 사람들이 작성한 테스트 케이스를 보고 jUnit을 사용하여 Mock 객체를 사용했는데 내가 지금 이걸 설명하기에는 공부가 더 더 필요하다. 단위테스트를 위해 
외부 모듈을 가짜로 만들어서 쓴다는 개념인데 그 이상으로 설명을 못하겠다. 전에 함수형 언어에 대한 내용을 배웠을 때 사이드 이펙트라는 용어를 들었는데 테스트 코드를 
만들면서 뒷길이 많으면 테스팅을 하기 힘들다고 생각했다. 결국 커버리지를 높여서 햇님을 봤는데 뿌듯하기도 하고 반대로 리팩토링을 제대로 한게 맞는건지 찔리는 구석도 생겼다.
